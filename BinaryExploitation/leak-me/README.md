# leak-me
__Category:__ Binary Exploitaion   
__Points:__ 200

### Problem:

Can you authenticate to this [service](auth) and get the flag? Connect with nc 2018shell3.picoctf.com 57659. [Source](auth.c).

##### Hints:
> Are all the system calls being used safely?

> Some people can have reallllllly long names you know..

### Solution:

I started by taking a quick look at the source. It contains two functions, flag an main. It appears flag prints the flag and main authorizes a user using a password stored in password.txt.
If the correct password is entered the main calls flag.

After a deeper look into the code I noticed a potential issue with the line 

```C
strcat(name, ",\nPlease Enter the Password.");
```

This appends ',\nPlease Enter the Password." onto name, however tere is nothing in the program to ensure there is space in name for these characters to be appended.
Thus if name is already full (or close to full) it will cause the name buffer to overflow.

At this point I ran the program and attempted to overflow name by entering 256+ chars (since 256 chars are allocated for the name buffer).

The password (a_reAllY_s3cuRe_p4s$word_56b977) seems to have been appended ont the string instead of "Please Enter the Password".

I then run the program again with a small name (so it desn't overflow again) and input the password to get the flag.

### Flag:

picoCTF{aLw4y5_Ch3cK_tHe_bUfF3r_s1z3_2b5cbbaa}
